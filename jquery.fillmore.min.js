/*!
 * jQuery Fillmore
 * Version 1.0.0
 * https://github.com/Gjslick/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2011 Gregory Jacobs (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(d){var c={src:null,centeredX:true,centeredY:true,speed:0};var b=function(g){var f="absolute";this.settings=d.extend({},c);var e=this.$containerEl=this.$containerSizingEl=d(g);e.css("background","transparent");if(e.is("body")){this.$containerSizingEl=("onorientationchange" in window)?d(document):d(window);f="fixed"}else{this.originalContainerOverflow=e[0].style.overflow;e.css("overflow","hidden");if(e.css("position")==="static"){e.css("position","relative");this.containerPositionModified=true}if(e.css("z-index")==="auto"){e.css("z-index",0);this.containerZIndexModified=true}}this.$fillmoreEl=d('<div style="left: 0; top: 0; position: '+f+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(e);this.resizeProxy=d.proxy(this.resize,this);d(window).resize(this.resizeProxy)};d.extend(b.prototype,{$imgEl:null,imgRatio:null,containerPositionModified:false,containerZIndexModified:false,loaded:false,updateSettings:function(e){this.settings=d.extend(this.settings,e)},showImage:function(e,f){this.$fillmoreEl.find("img").addClass("deletable");this.loaded=false;this.$imgEl=d('<img style="position: absolute; display: none; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load",d.proxy(function(g){this.onImageLoaded(g,f)},this)).appendTo(this.$fillmoreEl);this.$imgEl.attr("src",e)},onImageLoaded:function(f,j){var h=f.target,i=this.$fillmoreEl;if(h!==this.$imgEl[0]){return}this.$imgEl.css({width:"auto",height:"auto"});var g=h.width||this.$imgEl.width(),e=h.height||this.$imgEl.height();this.imgRatio=g/e;this.resize();this.$imgEl.fadeIn(this.settings.speed,jQuery.proxy(function(){i.find("img.deletable").remove();this.loaded=true;if(typeof j==="function"){j()}},this))},resize:function(){if(this.$imgEl){try{var e=this.settings,g=this.$containerEl,k=this.$containerSizingEl,n=k.outerHeight()||k.height(),l=k.outerWidth()||k.width(),j={left:0,top:0},i=l,h=i/this.imgRatio,m;if(h>=n){m=(h-n)/2;if(e.centeredY){d.extend(j,{top:"-"+m+"px"})}}else{h=n;i=h*this.imgRatio;m=(i-l)/2;if(e.centeredX){d.extend(j,{left:"-"+m+"px"})}}this.$fillmoreEl.width(i).height(h);this.$imgEl.width(i).height(h).css(j)}catch(f){}}},isLoaded:function(){return this.loaded},getSrc:function(){return this.settings.src},destroy:function(){if(this.containerPositionModified){this.$containerEl.css("position","")}if(this.containerZIndexModified){this.$containerEl.css("z-index","")}this.$containerEl.css("overflow",this.originalContainerOverflow);this.$fillmoreEl.remove();d(window).unbind("resize",this.resizeProxy)}});var a={init:function(k){for(var h=0,e=this.length;h<e;h++){var j=this[h],g=d(j),f=g.data("fillmore");if(!f){g.data("fillmore",f=new b(j))}f.updateSettings(k);f.showImage(k.src,k.callback)}return this},isLoaded:function(){var f=this[0],e;if(f&&(e=d(f).data("fillmore"))){return e.isLoaded()}else{return false}},getSrc:function(){var f=this[0],e;if(f&&(e=d(f).data("fillmore"))){return e.getSrc()}else{return undefined}},resize:function(){for(var h=0,e=this.length;h<e;h++){var g=d(this[h]),f=g.data("fillmore");if(f){f.resize()}}return this},destroy:function(){for(var h=0,e=this.length;h<e;h++){var g=d(this[h]),f=g.data("fillmore");if(f){f.destroy();g.removeData("fillmore")}}return this}};d.fn.fillmore=function(e){if(typeof e==="string"&&a[e]){return a[e].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof e==="object"||!e){return a.init.apply(this,arguments)}else{d.error("Method '"+e+"' does not exist on Fillmore.")}}};d.fillmore=function(e){return d("body").fillmore(e)}})(jQuery);