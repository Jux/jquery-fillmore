/*!
 * jQuery Fillmore
 * Version 1.0.0
 * https://github.com/gregjacobs/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2012 Gregory Jacobs with Aidan Feldman (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(a){a.Fillmore=function(c){this.init(c)};a.Fillmore.defaultSettings={src:null,focusX:50,focusY:50,speed:0,callback:undefined};var b=function(ah,ag,af){function Q(f,e){var h=f.charAt(0).toUpperCase()+f.substr(1),g=(f+" "+U.join(h+" ")+h).split(" ");return S(g,e)}function S(e,c){for(var f in e){if(Y[e[f]]!==af){return c=="pfx"?e[f]:!0}}return !1}function E(d,c){return !!~(""+d).indexOf(c)}function F(d,c){return typeof d===c}function G(d,c){return H(V.join(d+";")+(c||""))}function H(c){Y.cssText=c}var ae="2.0.6",ad={},ac=ag.documentElement,ab=ag.head||ag.getElementsByTagName("head")[0],aa="modernizr",Z=ag.createElement(aa),Y=Z.style,X,W=Object.prototype.toString,V=" -webkit- -moz- -o- -ms- -khtml- ".split(" "),U="Webkit Moz O ms Khtml".split(" "),T={},R={},P={},O=[],M=function(f,q,p,o){var n,m,l,h=ag.createElement("div");if(parseInt(p,10)){while(p--){l=ag.createElement("div"),l.id=o?o[p]:aa+(p+1),h.appendChild(l)}}n=["&shy;","<style>",f,"</style>"].join(""),h.id=aa,h.innerHTML+=n,ac.appendChild(h),m=q(h,f),h.parentNode.removeChild(h);return !!m},K,J={}.hasOwnProperty,I;!F(J,af)&&!F(J.call,af)?I=function(d,c){return J.call(d,c)}:I=function(d,c){return c in d&&F(d.constructor.prototype[c],af)};var N=function(j,i){var h=j.join(""),e=i.length;M(h,function(o,n){var m=ag.styleSheets[ag.styleSheets.length-1],l=m.cssRules&&m.cssRules[0]?m.cssRules[0].cssText:m.cssText||"",k=o.childNodes,g={};while(e--){g[k[e].id]=k[e]}ad.touch="ontouchstart" in ah||g.touch.offsetTop===9},e,i)}([,["@media (",V.join("touch-enabled),("),aa,")","{#touch{top:9px;position:absolute}}"].join("")],[,"touch"]);T.touch=function(){return ad.touch},T.backgroundsize=function(){return Q("backgroundSize")};for(var L in T){I(T,L)&&(K=L.toLowerCase(),ad[K]=T[L](),O.push((ad[K]?"":"no-")+K))}H(""),Z=X=null,ad._version=ae,ad._prefixes=V,ad._domPrefixes=U,ad.testProp=function(c){return S([c])},ad.testAllProps=Q,ad.testStyles=M;return ad}(this,this.document);a.Fillmore.useCss3=b.backgroundsize&&!(b.touch&&window.navigator.userAgent.match(/OS 4_/));a.extend(a.Fillmore.prototype,{fillmoreElPosition:"absolute",loaded:false,init:function(d){this.settings=a.extend({},a.Fillmore.defaultSettings);var c=this.$containerEl=a(d);c.css("background","transparent");if(c.is("body")){this.fillmoreElPosition="fixed"}else{this.originalContainerOverflow=c[0].style.overflow;c.css("overflow","hidden");if(c.css("position")==="static"){c.css("position","relative");this.containerPositionModified=true}if(c.css("z-index")==="auto"){c.css("z-index",0);this.containerZIndexModified=true}}this.createFillmoreEl()},createFillmoreEl:function(){this.$fillmoreEl=a('<div style="left: 0; top: 0; position: '+this.fillmoreElPosition+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl)},updateSettings:function(c){this.settings=a.extend(this.settings,c);if(c.centeredX){this.settings.focusX=50}if(c.centeredY){this.settings.focusY=50}},getImageEl:function(){throw new Error("getImageEl() must be implemented by subclass")},getImageSize:function(){if(this.loaded){var c=this.getImageEl()[0];return{width:c.width,height:c.height}}else{return{width:undefined,height:undefined}}},showImage:function(c,d){this.$deletable=this.getImageEl()},onImageLoaded:function(c,d){this.getImageEl().hide().fadeIn(this.settings.speed,a.proxy(function(){this.onImageVisible(d)},this))},onImageVisible:function(c){this.loaded=true;if(this.$deletable){this.$deletable.remove();this.$deletable=null}if(typeof c==="function"){c()}},resize:function(){throw new Error("resize() must be implemented by subclass")},isLoaded:function(){return this.loaded},getSrc:function(){return this.settings.src},destroy:function(){throw new Error("destroy() must be implemented by subclass")}})})(jQuery);(function(a){a.FillmoreCss3=function(b){this.init(b)};a.extend(a.FillmoreCss3.prototype,a.Fillmore.prototype,{getImageEl:function(){return this.$fillmoreEl},createFillmoreEl:function(){a.Fillmore.prototype.createFillmoreEl.apply(this,arguments);this.getImageEl().css({"background-position":this.settings.focusX+"% "+this.settings.focusY+"%","background-repeat":"no-repeat","background-size":"cover"})},resize:function(){},showImage:function(d,e){a.Fillmore.prototype.showImage.apply(this,arguments);this.createFillmoreEl();var c=new Image(),b=this;c.onload=c.onerror=a.proxy(function(f){this.getImageEl().css({"background-image":"url('"+d+"')"});this.onImageLoaded(f,e,d)},this);c.src=d},destroy:function(){this.getImageEl().css({"background-image":"","background-position":"","background-repeat":"","background-size":""})}})})(jQuery);(function(a){a.FillmoreImageStretch=function(b){this.init(b)};a.extend(a.FillmoreImageStretch.prototype,a.Fillmore.prototype,{$imgEl:null,imgRatio:null,containerPositionModified:false,containerZIndexModified:false,imgLoaded:false,init:function(b){a.Fillmore.prototype.init.apply(this,arguments);if(this.$containerEl.is("body")){this.$containerSizingEl=("onorientationchange" in window)?a(document):a(window)}else{this.$containerSizingEl=this.$containerEl}this.resizeProxy=a.proxy(this.resize,this);a(window).resize(this.resizeProxy)},getImageEl:function(){return this.$imgEl},showImage:function(b,c){a.Fillmore.prototype.showImage.apply(this,arguments);this.imgLoaded=false;this.loaded=false;this.$imgEl=a('<img style="position: absolute; display: none; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load error",a.proxy(function(d){this.onImageLoaded(d,c)},this)).appendTo(this.$fillmoreEl);this.$imgEl.attr("src",b)},onImageLoaded:function(c,g){var e=c.target,f=this.getImageEl();if(e!==f[0]){return}a.Fillmore.prototype.onImageLoaded.apply(this,arguments);this.imgLoaded=true;f.css({width:"auto",height:"auto"});var d=e.width||f.width(),b=e.height||f.height();this.imgRatio=d/b;this.resize()},resize:function(){if(this.$imgEl&&this.imgLoaded){try{var c=this.settings,e=this.$containerEl,j=this.$containerSizingEl,l=j.outerHeight()||j.height(),k=j.outerWidth()||j.width(),i={left:0,top:0},h=k,f=h/this.imgRatio;if(f>=l){var g=(f-l)*this.settings.focusY/100;a.extend(i,{top:"-"+g+"px"})}else{f=l;h=f*this.imgRatio;var b=(h-k)*this.settings.focusX/100;a.extend(i,{left:"-"+b+"px"})}this.$fillmoreEl.width(h).height(f);this.$imgEl.width(h).height(f).css(i)}catch(d){}}},destroy:function(){a.Fillmore.prototype.destroy.apply(this,arguments);if(this.containerPositionModified){this.$containerEl.css("position","")}if(this.containerZIndexModified){this.$containerEl.css("z-index","")}this.$containerEl.css("overflow",this.originalContainerOverflow);this.$fillmoreEl.remove();a(window).unbind("resize",this.resizeProxy)}})})(jQuery);(function(b){var a={init:function(h){for(var f=0,c=this.length;f<c;f++){var g=this[f],e=b(g),d=e.data("fillmore");if(!d){if(b.Fillmore.useCss3&&!h.noCss3){d=new b.FillmoreCss3(g)}else{d=new b.FillmoreImageStretch(g)}e.data("fillmore",d)}d.updateSettings(h);d.showImage(h.src,h.callback)}return this},isLoaded:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.isLoaded()}else{return false}},getSrc:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getSrc()}else{return undefined}},getImageSize:function(){var d=this[0],c;if(d&&(c=b(d).data("fillmore"))){return c.getImageSize()}else{return undefined}},resize:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.resize()}}return this},destroy:function(){for(var f=0,c=this.length;f<c;f++){var e=b(this[f]),d=e.data("fillmore");if(d){d.destroy();e.removeData("fillmore")}}return this}};b.fn.fillmore=function(c){if(typeof c==="string"&&a[c]){return a[c].apply(this,Array.prototype.slice.call(arguments,1))}else{if(typeof c==="object"||!c){return a.init.apply(this,arguments)}else{b.error("Method '"+c+"' does not exist on Fillmore.")}}};b.fillmore=function(c){return b("body").fillmore(c)}})(jQuery);