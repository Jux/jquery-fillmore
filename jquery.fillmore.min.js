/*!
 * jQuery Fillmore
 * Version 1.4.1
 * https://github.com/gregjacobs/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2012 Gregory Jacobs with Aidan Feldman (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(t){t.Fillmore=function(t){this.init(t)},t.Fillmore.defaultSettings={src:null,focusX:50,focusY:50,speed:0,onImageLoad:void 0,onImageVisible:void 0,callback:void 0};var e=function(t,e,i){function n(t){y.cssText=t}function o(t,e){return typeof t===e}function r(t,e){return!!~(""+t).indexOf(e)}function s(t,e){for(var n in t){var o=t[n];if(!r(o,"-")&&y[o]!==i)return"pfx"==e?o:!0}return!1}function a(t,e,n){for(var r in t){var s=e[t[r]];if(s!==i)return n===!1?t[r]:o(s,"function")?s.bind(n||e):s}return!1}function l(t,e,i){var n=t.charAt(0).toUpperCase()+t.slice(1),r=(t+" "+I.join(n+" ")+n).split(" ");return o(e,"string")||o(e,"undefined")?s(r,e):(r=(t+" "+E.join(n+" ")+n).split(" "),a(r,e,i))}var d,h,c,u="2.6.2",f={},g=e.documentElement,m="modernizr",p=e.createElement(m),y=p.style,v=({}.toString,"Webkit Moz O ms"),I=v.split(" "),E=v.toLowerCase().split(" "),b={},w=[],$=w.slice,z={}.hasOwnProperty;c=o(z,"undefined")||o(z.call,"undefined")?function(t,e){return e in t&&o(t.constructor.prototype[e],"undefined")}:function(t,e){return z.call(t,e)},Function.prototype.bind||(Function.prototype.bind=function(t){var e=this;if("function"!=typeof e)throw new TypeError;var i=$.call(arguments,1),n=function(){if(this instanceof n){var o=function(){};o.prototype=e.prototype;var r=new o,s=e.apply(r,i.concat($.call(arguments)));return Object(s)===s?s:r}return e.apply(t,i.concat($.call(arguments)))};return n}),b.backgroundsize=function(){return l("backgroundSize")};for(var F in b)c(b,F)&&(h=F.toLowerCase(),f[h]=b[F](),w.push((f[h]?"":"no-")+h));return f.addTest=function(t,e){if("object"==typeof t)for(var n in t)c(t,n)&&f.addTest(n,t[n]);else{if(t=t.toLowerCase(),f[t]!==i)return f;e="function"==typeof e?e():e,"undefined"!=typeof enableClasses&&enableClasses&&(g.className+=" "+(e?"":"no-")+t),f[t]=e}return f},n(""),p=d=null,f._version=u,f._domPrefixes=E,f._cssomPrefixes=I,f.testProp=function(t){return s([t])},f.testAllProps=l,f}(this,this.document);t.Fillmore.useCss3=e.backgroundsize&&!/i(Phone|Pod|Pad).*OS 4_/.test(window.navigator.userAgent),t.extend(t.Fillmore.prototype,{fillmoreElPosition:"absolute",imageLoaded:!1,imageVisible:!1,init:function(e){this.settings=t.extend({},t.Fillmore.defaultSettings);var i=this.$containerEl=t(e);i.css("background","transparent"),i.is("body")?this.fillmoreElPosition="fixed":(this.originalContainerOverflow=i[0].style.overflow,i.css("overflow","hidden"),"static"===i.css("position")&&(i.css("position","relative"),this.containerPositionModified=!0),"auto"===i.css("z-index")&&(i.css("z-index",0),this.containerZIndexModified=!0)),this.$containerSizingEl=this.$containerEl.is("body")?"onorientationchange"in window?t(document):t(window):this.$containerEl,this.createFillmoreEl()},createFillmoreEl:function(){this.$fillmoreEl=t('<div class="fillmoreInner" style="left: 0; top: 0; position: '+this.fillmoreElPosition+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl)},updateSettings:function(e){this.settings=t.extend(this.settings,e)},getSrc:function(){return this.settings.src},getImageEl:function(){throw Error("getImageEl() must be implemented in subclass")},getImageSize:function(){if(this.imageLoaded){var t=this.getImageEl()[0];return{width:t.width,height:t.height}}return null},calculateStretchedSizeAndOffsets:function(){var t=this.getImageEl(),e=t[0];t.css({width:"auto",height:"auto"});var i=e.width||t.width(),n=e.height||t.height(),o=i/n,r=(this.settings,this.$containerEl,this.$containerSizingEl),s=r.outerHeight()||r.height(),a=r.outerWidth()||r.width(),l=0,d=0,h=a,c=h/o;return c>=s?d=(c-s)*this.settings.focusY/100:(c=s,h=c*o,l=(h-a)*this.settings.focusX/100),{offsetLeft:l,offsetTop:d,stretchedWidth:h,stretchedHeight:c}},getViewableImageArea:function(){if(this.imageLoaded){var t=this.$containerEl,e=this.calculateStretchedSizeAndOffsets();return{width:t.innerWidth(),height:t.innerHeight(),offsetLeft:e.offsetLeft,offsetTop:e.offsetTop,stretchedWidth:e.stretchedWidth,stretchedHeight:e.stretchedHeight}}return null},showImage:function(t){this.imageLoaded=!1,this.imageVisible=!1,this.loadImage(t)},loadImage:function(){throw Error("loadImage() must be implemented in subclass")},isLoaded:function(){return this.imageIsVisible()},imageIsLoaded:function(){return this.imageLoaded},imageIsVisible:function(){return this.imageVisible},resize:function(){throw Error("resize() must be implemented in subclass")},onImageLoad:function(){this.imageLoaded=!0;var e=this.settings.onImageLoad;"function"==typeof e&&e(),this.settings.speed?(this.$fillmoreEl.hide().fadeIn(this.settings.speed,t.proxy(this.onImageVisible,this)),this.settings.speed=0):this.onImageVisible()},onImageVisible:function(){this.imageVisible=!0;var t=this.settings,e=t.onImageVisible||t.callback;"function"==typeof e&&e()},destroy:function(){this.containerPositionModified&&this.$containerEl.css("position",""),this.containerZIndexModified&&this.$containerEl.css("z-index",""),this.$containerEl.css("overflow",this.originalContainerOverflow),this.$fillmoreEl.remove()}})})(jQuery),function(t){t.FillmoreCss3=function(){t.Fillmore.apply(this,arguments)},t.extend(t.FillmoreCss3.prototype,t.Fillmore.prototype,{$imgEl:null,createFillmoreEl:function(){t.Fillmore.prototype.createFillmoreEl.apply(this,arguments),this.$fillmoreEl.css({"background-repeat":"no-repeat","background-size":"cover"})},updateSettings:function(){t.Fillmore.prototype.updateSettings.apply(this,arguments),this.$fillmoreEl.css("background-position",this.settings.focusX+"% "+this.settings.focusY+"%")},getImageEl:function(){return this.$imgEl||null},resize:function(){},loadImage:function(e){this.$imgEl=t("<img />").bind("load error",t.proxy(this.onImageLoad,this)),this.$imgEl.attr("src",e)},onImageLoad:function(){var e=this.$imgEl[0].src;this.$fillmoreEl.css("background-image","url('"+e+"')"),t.Fillmore.prototype.onImageLoad.apply(this,arguments)}})}(jQuery),function(t){t.FillmoreImageStretch=function(){t.Fillmore.apply(this,arguments)},t.extend(t.FillmoreImageStretch.prototype,t.Fillmore.prototype,{$imgEl:null,$oldImage:null,init:function(){t.Fillmore.prototype.init.apply(this,arguments),this.resizeProxy=t.proxy(this.resize,this),t(window).resize(this.resizeProxy)},getImageEl:function(){return this.$imgEl||null},loadImage:function(e){this.$oldImage=this.$imgEl,this.$imgEl=t('<img style="position: absolute; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load error",t.proxy(this.onImageLoad,this)).appendTo(this.$fillmoreEl),this.$imgEl.attr("src",e)},onImageLoad:function(e){var i=e.target,n=this.getImageEl();i===n[0]&&(this.$oldImage&&(this.$oldImage.remove(),this.$oldImage=null),t.Fillmore.prototype.onImageLoad.apply(this,arguments),this.resize())},resize:function(){if(this.$imgEl&&this.imageLoaded)try{var t=this.calculateStretchedSizeAndOffsets(),e={left:"-"+t.offsetLeft+"px",top:"-"+t.offsetTop+"px"};this.$fillmoreEl.width(t.stretchedWidth).height(t.stretchedHeight),this.$imgEl.width(t.stretchedWidth).height(t.stretchedHeight).css(e)}catch(i){}},destroy:function(){t(window).unbind("resize",this.resizeProxy),t.Fillmore.prototype.destroy.apply(this,arguments)}})}(jQuery),function(t){var e={init:function(e){for(var i=0,n=this.length;n>i;i++){var o=this[i],r=t(o),s=r.data("fillmore");s||(s=t.Fillmore.useCss3&&!e.noCss3||e.forceCss3?new t.FillmoreCss3(o):new t.FillmoreImageStretch(o),r.data("fillmore",s)),s.updateSettings(e),s.showImage(e.src)}return this},getSrc:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.getSrc():void 0},getImageSize:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.getImageSize():void 0},getViewableImageArea:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.getViewableImageArea():void 0},isLoaded:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.isLoaded():!1},imageIsLoaded:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.imageIsLoaded():!1},imageIsVisible:function(){var e,i=this[0];return i&&(e=t(i).data("fillmore"))?e.imageIsVisible():!1},resize:function(){for(var e=0,i=this.length;i>e;e++){var n=t(this[e]),o=n.data("fillmore");o&&o.resize()}return this},destroy:function(){for(var e=0,i=this.length;i>e;e++){var n=t(this[e]),o=n.data("fillmore");o&&(o.destroy(),n.removeData("fillmore"))}return this}};t.fn.fillmore=function(i){return"string"==typeof i&&e[i]?e[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(t.error("Method '"+i+"' does not exist on Fillmore."),void 0):e.init.apply(this,arguments)},t.fillmore=function(e){return t("body").fillmore(e)}}(jQuery);