/*
 * jQuery Fillmore
 * Version 0.1.0
 * https://github.com/Gjslick/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2011 Gregory Jacobs (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function($){var defaultSettings={centeredX:true,centeredY:true,speed:0};var Fillmore=function(containerEl){var fillmoreElPosition='absolute';this.zIndex=-1;this.$containerEl=$(containerEl).css({position:'relative',background:'transparent'});this.$containerSizingEl=this.$containerEl;if(this.$containerSizingEl.is('body')){this.$containerSizingEl=('onorientationchange'in window)?$(document):$(window);fillmoreElPosition='fixed';this.zIndex=-999999;}else{this.$containerEl.css('overflow','hidden');}
this.settings=$.extend({},defaultSettings);this.$fillmoreEl=$('<div style="left: 0; top: 0; position: '+fillmoreElPosition+'; overflow: hidden; z-index: '+this.zIndex+'; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl);this.$img=null;this.imgRatio=null;$(window).resize($.proxy(this.adjustBG,this));};Fillmore.prototype={constructor:Fillmore,updateSettings:function(settings){this.settings=$.extend(this.settings,settings);},showImage:function(src,callback){this.$fillmoreEl.find('img').addClass('deletable');this.$img=$('<img style="position: absolute; display: none; margin: 0; padding: 0; border: none; z-index: '+this.zIndex+';" />').bind('load',$.proxy(function(evt){this.onImageLoaded(evt,callback);},this)).appendTo(this.$fillmoreEl);this.$img.attr("src",src);},onImageLoaded:function(evt,callback){var img=evt.target,$fillmoreEl=this.$fillmoreEl;this.$img.css({width:"auto",height:"auto"});var imgWidth=img.width||this.$img.width(),imgHeight=img.height||this.$img.height();this.imgRatio=imgWidth/imgHeight;this.adjustBG();this.$img.fadeIn(this.settings.speed,function(){$fillmoreEl.find('img.deletable').remove();if(typeof callback==="function"){callback();}});},adjustBG:function(){if(this.$img){try{var settings=this.settings,$containerEl=this.$containerEl,$containerSizingEl=this.$containerSizingEl,containerHeight=$containerSizingEl.outerHeight()||$containerSizingEl.height(),containerWidth=$containerSizingEl.outerWidth()||$containerSizingEl.width(),bgCSS={left:0,top:0},bgWidth=containerWidth,bgHeight=bgWidth/this.imgRatio,bgOffset;if(bgHeight>=containerHeight){bgOffset=(bgHeight-containerHeight)/2;if(settings.centeredY){$.extend(bgCSS,{top:"-"+bgOffset+"px"});}}else{bgHeight=containerHeight;bgWidth=bgHeight*this.imgRatio;bgOffset=(bgWidth-containerWidth)/2;if(settings.centeredX){$.extend(bgCSS,{left:"-"+bgOffset+"px"});}}
this.$fillmoreEl.width(bgWidth).height(bgHeight);this.$img.width(bgWidth).height(bgHeight).css(bgCSS);}catch(err){}}}};$.fn.fillmore=function(src,settings,callback){return this.each(function(idx,el){var $el=$(el),fillmore=$el.data('fillmore');if(!fillmore){fillmore=new Fillmore(el);$el.data('fillmore',fillmore);}
fillmore.updateSettings(settings);fillmore.showImage(src,callback);});};$.fillmore=function(src,settings,callback){$(document).ready(function(){$('body').fillmore(src,settings,callback);});};})(jQuery);