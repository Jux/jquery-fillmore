/*!
 * jQuery Fillmore
 * Version 1.4.1
 * https://github.com/gregjacobs/jquery-fillmore
 *
 * Add a dynamically-resized background image to any element
 *
 * Copyright (c) 2012 Gregory Jacobs with Aidan Feldman (jux.com)
 * Dual licensed under the MIT and GPL licenses.
 */
(function(e){e.Fillmore=function(e){this.init(e)},e.Fillmore.defaultSettings={src:null,focusX:50,focusY:50,speed:0,onImageLoad:void 0,onImageVisible:void 0,callback:void 0};var t=function(e,t,i){function o(e){y.cssText=e}function n(e,t){return typeof e===t}function r(e,t){return!!~(""+e).indexOf(t)}function s(e,t){for(var o in e){var n=e[o];if(!r(n,"-")&&y[n]!==i)return"pfx"==t?n:!0}return!1}function l(e,t,o){for(var r in e){var s=t[e[r]];if(s!==i)return o===!1?e[r]:n(s,"function")?s.bind(o||t):s}return!1}function a(e,t,i){var o=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+E.join(o+" ")+o).split(" ");return n(t,"string")||n(t,"undefined")?s(r,t):(r=(e+" "+I.join(o+" ")+o).split(" "),l(r,t,i))}var c,d,h,u="2.6.2",f={},m=t.documentElement,g="modernizr",p=t.createElement(g),y=p.style,v=({}.toString,"Webkit Moz O ms"),E=v.split(" "),I=v.toLowerCase().split(" "),b={},w=[],F=w.slice,$={}.hasOwnProperty;h=n($,"undefined")||n($.call,"undefined")?function(e,t){return t in e&&n(e.constructor.prototype[t],"undefined")}:function(e,t){return $.call(e,t)},Function.prototype.bind||(Function.prototype.bind=function(e){var t=this;if("function"!=typeof t)throw new TypeError;var i=F.call(arguments,1),o=function(){if(this instanceof o){var n=function(){};n.prototype=t.prototype;var r=new n,s=t.apply(r,i.concat(F.call(arguments)));return Object(s)===s?s:r}return t.apply(e,i.concat(F.call(arguments)))};return o}),b.backgroundsize=function(){return a("backgroundSize")};for(var z in b)h(b,z)&&(d=z.toLowerCase(),f[d]=b[z](),w.push((f[d]?"":"no-")+d));return f.addTest=function(e,t){if("object"==typeof e)for(var o in e)h(e,o)&&f.addTest(o,e[o]);else{if(e=e.toLowerCase(),f[e]!==i)return f;t="function"==typeof t?t():t,"undefined"!=typeof enableClasses&&enableClasses&&(m.className+=" "+(t?"":"no-")+e),f[e]=t}return f},o(""),p=c=null,f._version=u,f._domPrefixes=I,f._cssomPrefixes=E,f.testProp=function(e){return s([e])},f.testAllProps=a,f}(this,this.document);e.Fillmore.useCss3=t.backgroundsize&&!/i(Phone|Pod|Pad).*OS 4_/.test(window.navigator.userAgent),e.extend(e.Fillmore.prototype,{fillmoreElPosition:"absolute",imageLoaded:!1,imageVisible:!1,init:function(t){this.settings=e.extend({},e.Fillmore.defaultSettings);var i=this.$containerEl=e(t);i.css("background","transparent"),i.is("body")?this.fillmoreElPosition="fixed":(this.originalContainerOverflow=i[0].style.overflow,i.css("overflow","hidden"),"static"===i.css("position")&&(i.css("position","relative"),this.containerPositionModified=!0),"auto"===i.css("z-index")&&(i.css("z-index",0),this.containerZIndexModified=!0)),this.$containerSizingEl=this.$containerEl.is("body")?"onorientationchange"in window?e(document):e(window):this.$containerEl,this.createFillmoreEl()},createFillmoreEl:function(){this.$fillmoreEl=e('<div class="fillmoreInner" style="left: 0; top: 0; position: '+this.fillmoreElPosition+'; overflow: hidden; z-index: -999999; margin: 0; padding: 0; height: 100%; width: 100%;" />').appendTo(this.$containerEl)},updateSettings:function(t){this.settings=e.extend(this.settings,t)},getSrc:function(){return this.settings.src},getImageEl:function(){throw Error("getImageEl() must be implemented in subclass")},getImageSize:function(){if(this.imageLoaded){var e=this.getImageEl()[0];return{width:e.width,height:e.height}}return null},calculateStretchedSizeAndOffsets:function(){var e=this.getImageEl(),t=e[0];e.css({width:"auto",height:"auto"});var i=t.width||e.width(),o=t.height||e.height(),n=i/o,r=(this.settings,this.$containerEl,this.$containerSizingEl),s=r.outerHeight()||r.height(),l=r.outerWidth()||r.width(),a=0,c=0,d=l,h=d/n;return h>=s?c=(h-s)*this.settings.focusY/100:(h=s,d=h*n,a=(d-l)*this.settings.focusX/100),{offsetLeft:a,offsetTop:c,stretchedWidth:d,stretchedHeight:h}},getViewableImageArea:function(){if(this.imageLoaded){var e=this.$containerEl,t=this.calculateStretchedSizeAndOffsets();return{width:e.innerWidth(),height:e.innerHeight(),offsetLeft:t.offsetLeft,offsetTop:t.offsetTop,stretchedWidth:t.stretchedWidth,stretchedHeight:t.stretchedHeight}}return null},showImage:function(e){this.imageLoaded=!1,this.imageVisible=!1,this.loadImage(e)},loadImage:function(){throw Error("loadImage() must be implemented in subclass")},isLoaded:function(){return this.imageIsVisible()},imageIsLoaded:function(){return this.imageLoaded},imageIsVisible:function(){return this.imageVisible},resize:function(){throw Error("resize() must be implemented in subclass")},onImageLoad:function(){this.imageLoaded=!0;var t=this.settings.onImageLoad;"function"==typeof t&&t(),this.settings.speed?(this.$fillmoreEl.hide().fadeIn(this.settings.speed,e.proxy(this.onImageVisible,this)),this.settings.speed=0):this.onImageVisible()},onImageVisible:function(){this.imageVisible=!0;var e=this.settings,t=e.onImageVisible||e.callback;"function"==typeof t&&t()},destroy:function(){this.containerPositionModified&&this.$containerEl.css("position",""),this.containerZIndexModified&&this.$containerEl.css("z-index",""),this.$containerEl.css("overflow",this.originalContainerOverflow),this.$fillmoreEl.remove()}})})(jQuery),function(e){e.FillmoreCss3=function(){e.Fillmore.apply(this,arguments)},e.extend(e.FillmoreCss3.prototype,e.Fillmore.prototype,{$imgEl:null,createFillmoreEl:function(){e.Fillmore.prototype.createFillmoreEl.apply(this,arguments),this.$fillmoreEl.css("background-repeat","no-repeat")},updateSettings:function(){e.Fillmore.prototype.updateSettings.apply(this,arguments),this.$fillmoreEl.css("background-position",this.settings.focusX+"% "+this.settings.focusY+"%")},getImageEl:function(){return this.$imgEl||null},resize:function(){},loadImage:function(t){this.$imgEl=e("<img />").bind("load error",e.proxy(this.onImageLoad,this)),this.$imgEl.attr("src",t)},onImageLoad:function(){var t=this.$imgEl[0].src;this.$fillmoreEl.css("background-image","url('"+t+"')"),e.Fillmore.prototype.onImageLoad.apply(this,arguments)}})}(jQuery),function(e){e.FillmoreCss3Frame=function(){e.FillmoreCss3.apply(this,arguments)},e.extend(e.FillmoreCss3Frame.prototype,e.FillmoreCss3.prototype,{createFillmoreEl:function(){e.FillmoreCss3.prototype.createFillmoreEl.apply(this,arguments)}})}(jQuery),function(e){e.FillmoreCss3Cover=function(){e.FillmoreCss3.apply(this,arguments)},e.extend(e.FillmoreCss3Cover.prototype,e.FillmoreCss3.prototype,{createFillmoreEl:function(){e.FillmoreCss3.prototype.createFillmoreEl.apply(this,arguments),this.$fillmoreEl.css("background-size","cover")}})}(jQuery),function(e){e.FillmoreImageStretch=function(){e.Fillmore.apply(this,arguments)},e.extend(e.FillmoreImageStretch.prototype,e.Fillmore.prototype,{$imgEl:null,$oldImage:null,init:function(){e.Fillmore.prototype.init.apply(this,arguments),this.resizeProxy=e.proxy(this.resize,this),e(window).resize(this.resizeProxy)},getImageEl:function(){return this.$imgEl||null},loadImage:function(t){this.$oldImage=this.$imgEl,this.$imgEl=e('<img style="position: absolute; margin: 0; padding: 0; border: none; z-index: -999999;" />').bind("load error",e.proxy(this.onImageLoad,this)).appendTo(this.$fillmoreEl),this.$imgEl.attr("src",t)},onImageLoad:function(t){var i=t.target,o=this.getImageEl();i===o[0]&&(this.$oldImage&&(this.$oldImage.remove(),this.$oldImage=null),e.Fillmore.prototype.onImageLoad.apply(this,arguments),this.resize())},resize:function(){if(this.$imgEl&&this.imageLoaded)try{var e=this.calculateStretchedSizeAndOffsets(),t={left:"-"+e.offsetLeft+"px",top:"-"+e.offsetTop+"px"};this.$fillmoreEl.width(e.stretchedWidth).height(e.stretchedHeight),this.$imgEl.width(e.stretchedWidth).height(e.stretchedHeight).css(t)}catch(i){}},destroy:function(){e(window).unbind("resize",this.resizeProxy),e.Fillmore.prototype.destroy.apply(this,arguments)}})}(jQuery),function(e){var t={init:function(t){for(var i=0,o=this.length;o>i;i++){var n=this[i],r=e(n),s=r.data("fillmore");if(!s){if(e.Fillmore.useCss3&&!t.noCss3||t.forceCss3)switch(t.mode){case"contain":s=new e.FillmoreCss3Frame(n);break;case"cover":s=new e.FillmoreCss3Cover(n);break;default:throw Error("unknown mode: "+t.mode)}else s=new e.FillmoreImageStretch(n);r.data("fillmore",s)}s.updateSettings(t),s.showImage(t.src)}return this},getSrc:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.getSrc():void 0},getImageSize:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.getImageSize():void 0},getViewableImageArea:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.getViewableImageArea():void 0},isLoaded:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.isLoaded():!1},imageIsLoaded:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.imageIsLoaded():!1},imageIsVisible:function(){var t,i=this[0];return i&&(t=e(i).data("fillmore"))?t.imageIsVisible():!1},resize:function(){for(var t=0,i=this.length;i>t;t++){var o=e(this[t]),n=o.data("fillmore");n&&n.resize()}return this},destroy:function(){for(var t=0,i=this.length;i>t;t++){var o=e(this[t]),n=o.data("fillmore");n&&(n.destroy(),o.removeData("fillmore"))}return this}};e.fn.fillmore=function(i){return"string"==typeof i&&t[i]?t[i].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof i&&i?(e.error("Method '"+i+"' does not exist on Fillmore."),void 0):t.init.apply(this,arguments)},e.fillmore=function(t){return e("body").fillmore(t)}}(jQuery);